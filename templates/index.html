{% extends 'base.html' %}

{% block content %}

<body class="dark:bg-slate-800 w-screen h-screen flex flex-col items-center justify-center gap-4">

    <script>
        var jokeCounter = 0;

        function hideSupertabButton() {
            console.log("Hide supertab button")
            document.getElementById('supertab-button').classList.add("hidden");
        }
        function showSupertabButton() {
            console.log("Show supertab button")
            document.getElementById('supertab-button').classList.remove("hidden");
        }
        function hideJokeButton() {
            console.log("Hide joke button")
            document.getElementById('joke-button').classList.add("hidden");
        }
        function showJokeButton() {
            console.log("Show joke button")
            document.getElementById('joke-button').classList.remove("hidden");
        }
        function countJokes() {
            console.log("Joke counter: " + jokeCounter)
            if (jokeCounter < 5) {
                hideSupertabButton();
                showJokeButton();
                jokeCounter++;
            } else {
                showSupertabButton();
                hideJokeButton();
            }
            console.log("Joke counter: " + jokeCounter)
        }

    </script>

    <script type="module">
      import "https://js.supertab.co/v1/tab.js";
      window.supertab.createPurchaseButton({
        containerElement: document.getElementById("supertab-button"),
        clientId: "client.d0bbefda-39bb-406b-a0f2-d45cd1522990",
        merchantName: "Penguin Jokes",
        merchantLogoUrl: "https://filipa.pythonanywhere.com/static/img/thinking.svg",
        offeringId: "offering.0af943fa-3655-4058-83f4-a05efb351a5e", // optional
        onPurchaseCompleted: () => {
          console.log("Purchase completed!");
          jokeCounter = 0;
          hideSupertabButton();
          showJokeButton();
        },
        onPurchaseCanceled: () => {
          //insert your code to handle when purchase is not completed
          console.log("Purchase canceled!");
          jokeCounter = 0;
          hideSupertabButton();
          showJokeButton();
        },
        onError: () => {
          //insert your code to handle an unexpected error
          console.log("Purchase error!");
          jokeCounter = 0;
          hideSupertabButton();
          showJokeButton();
        },
      });
    </script>

    <!-- include the joke fragment -->
    {% include 'joke.html' %}
</body>
</html>
{% endblock %}
